(()=>{"use strict";class t{static async getProspects(){return(await chrome.storage.local.get(this.PROSPECTS_KEY))[this.PROSPECTS_KEY]||[]}static async saveProspects(t){await chrome.storage.local.set({[this.PROSPECTS_KEY]:t})}static async addProspects(t){const a=await this.getProspects(),s=new Set(a.map(t=>t.id)),e=t.filter(t=>!s.has(t.id));if(e.length>0){const t=[...a,...e];await this.saveProspects(t);const s=await this.getStats();s.totalScanned=t.length,s.newProspectsCount+=e.length,s.lastScanDate=Date.now(),await this.saveStats(s)}}static async updateProspect(t,a){const s=await this.getProspects(),e=s.findIndex(a=>a.id===t);-1!==e&&(s[e]={...s[e],...a},await this.saveProspects(s))}static async deleteProspect(t){const a=(await this.getProspects()).filter(a=>a.id!==t);await this.saveProspects(a)}static async getStats(){return(await chrome.storage.local.get(this.STATS_KEY))[this.STATS_KEY]||{totalScanned:0,lastScanDate:0,newProspectsCount:0}}static async saveStats(t){await chrome.storage.local.set({[this.STATS_KEY]:t})}static async clearAll(){await chrome.storage.local.clear()}static async exportToCSV(){const t=(await this.getProspects()).map(t=>[t.name,t.headline,t.currentCompany||"",t.location||"",t.mutualConnections?.toString()||"0",t.profileUrl,t.status,t.notes||"",t.tags?.join("; ")||""]);return[["Name","Headline","Company","Location","Mutual Connections","Profile URL","Status","Notes","Tags"].join(","),...t.map(t=>t.map(t=>`"${t.replace(/"/g,'""')}"`).join(","))].join("\n")}static async getPrioritySettings(){return(await chrome.storage.local.get(this.PRIORITY_SETTINGS_KEY))[this.PRIORITY_SETTINGS_KEY]||null}static async savePrioritySettings(t){await chrome.storage.local.set({[this.PRIORITY_SETTINGS_KEY]:t})}static async getTemplates(){return(await chrome.storage.local.get(this.TEMPLATES_KEY))[this.TEMPLATES_KEY]||[]}static async saveTemplates(t){await chrome.storage.local.set({[this.TEMPLATES_KEY]:t})}static async addTemplate(t){const a=await this.getTemplates();a.push(t),await this.saveTemplates(a)}static async deleteTemplate(t){const a=(await this.getTemplates()).filter(a=>a.id!==t);await this.saveTemplates(a)}static async getCampaigns(){return(await chrome.storage.local.get(this.CAMPAIGNS_KEY))[this.CAMPAIGNS_KEY]||[]}static async saveCampaigns(t){await chrome.storage.local.set({[this.CAMPAIGNS_KEY]:t})}static async addCampaign(t){const a=await this.getCampaigns();a.push(t),await this.saveCampaigns(a)}static async updateCampaign(t,a){const s=await this.getCampaigns(),e=s.findIndex(a=>a.id===t);-1!==e&&(s[e]={...s[e],...a},await this.saveCampaigns(s))}static async deleteCampaign(t){const a=(await this.getCampaigns()).filter(a=>a.id!==t);await this.saveCampaigns(a)}}t.PROSPECTS_KEY="linkedin_prospects",t.STATS_KEY="scan_stats",t.PRIORITY_SETTINGS_KEY="priority_settings",t.CAMPAIGNS_KEY="message_campaigns",t.TEMPLATES_KEY="message_templates",chrome.runtime.onMessage.addListener((a,s,e)=>("SAVE_PROSPECTS"===a.type?(async function(a){try{await t.addProspects(a),console.log(`Saved ${a.length} prospects`);const s=(await t.getProspects()).filter(t=>"new"===t.status).length;s>0&&(chrome.action.setBadgeText({text:s.toString()}),chrome.action.setBadgeBackgroundColor({color:"#0a66c2"}))}catch(t){console.error("Error saving prospects:",t)}}(a.prospects),e({success:!0})):"UPDATE_PROSPECT"===a.type?(async function(a,s){try{await t.updateProspect(a,s),console.log(`Updated prospect ${a}:`,s)}catch(t){console.error("Error updating prospect:",t)}}(a.id,a.updates),e({success:!0})):"SCAN_START"===a.type?console.log("Scan started"):"SCAN_COMPLETE"===a.type&&(console.log("Scan completed"),chrome.action.setBadgeText({text:"Done"}),setTimeout(()=>{chrome.action.setBadgeText({text:""})},3e3)),!0)),chrome.runtime.onInstalled.addListener(()=>{console.log("LinkedIn Connection Scanner installed")})})();